function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{Tjht:function(e,t,r){"use strict";r.r(t),r.d(t,"CheckoutModule",(function(){return E}));var n=r("tyNb"),a=r("3Pt+"),o=r("jtHE"),i=r("1G5W"),c=r("OaWH"),u=r("Tj/N"),l=r("fXoL"),s=r("lGQG"),b=r("c14U"),m=r("tLlE"),d=r("DJIC"),f=r("ofXK"),p=r("kmnG"),h=r("qFsG"),g=r("bTqV"),y=r("Wp6s"),C=r("YK+t");function v(e,t){1&e&&(l.Ub(0,"span"),l.Cc(1,"Confirm"),l.Tb())}function T(e,t){1&e&&(l.Ub(0,"span"),l.Cc(1,"Sending..."),l.Tb())}function k(e,t){if(1&e){var r=l.Vb();l.Ub(0,"div"),l.Ub(1,"div",2),l.Ub(2,"div",3),l.Ub(3,"h3"),l.Cc(4,"All fields is required"),l.Tb(),l.Ub(5,"form",4),l.Ub(6,"mat-form-field",5),l.Ub(7,"mat-label"),l.Cc(8,"Email"),l.Tb(),l.Pb(9,"input",6),l.Tb(),l.Pb(10,"br"),l.Ub(11,"mat-form-field",5),l.Ub(12,"mat-label"),l.Cc(13,"First name"),l.Tb(),l.Pb(14,"input",7),l.Tb(),l.Pb(15,"br"),l.Ub(16,"mat-form-field",5),l.Ub(17,"mat-label"),l.Cc(18,"Last name"),l.Tb(),l.Pb(19,"input",8),l.Tb(),l.Pb(20,"br"),l.Ub(21,"mat-form-field",5),l.Ub(22,"mat-label"),l.Cc(23,"Address"),l.Tb(),l.Pb(24,"input",9),l.Tb(),l.Tb(),l.Ub(25,"button",10),l.cc("click",(function(){return l.uc(r),l.gc().goBack()})),l.Cc(26,"Back to Cart"),l.Tb(),l.Ub(27,"button",11),l.cc("click",(function(){return l.uc(r),l.gc().submitForm()})),l.Ac(28,v,2,0,"span",1),l.Ac(29,T,2,0,"span",1),l.Tb(),l.Tb(),l.Ub(30,"div",12),l.Ub(31,"mat-card"),l.Pb(32,"order",13),l.Tb(),l.Tb(),l.Tb(),l.Tb()}if(2&e){var n=l.gc();l.Cb(5),l.mc("formGroup",n.orderFormGroup),l.Cb(22),l.mc("disabled",n.loading),l.Cb(1),l.mc("ngIf",!n.loading),l.Cb(1),l.mc("ngIf",n.loading),l.Cb(3),l.mc("cart",n.cart)("currency",n.currencyState)("totalPrice",n.getTotalPrice())("mode","ORDER")}}function O(e,t){if(1&e&&(l.Ub(0,"span"),l.Pb(1,"br"),l.Cc(2),l.Tb()),2&e){var r=l.gc(2);l.Cb(2),l.Ec("If you want to see your orders history, you can register use ",r.orderFormGroup.value.email," email.")}}function P(e,t){if(1&e&&(l.Ub(0,"div"),l.Ub(1,"div",14),l.Cc(2," Your order is complete!"),l.Ac(3,O,3,1,"span",1),l.Tb(),l.Ub(4,"div",15),l.Ub(5,"a",16),l.Cc(6,"Go to home page"),l.Tb(),l.Tb(),l.Tb()),2&e){var r=l.gc();l.Cb(3),l.mc("ngIf",!r.user.id)}}var U,w,_,x=[{path:"",component:(U=function(){function e(t,r,n,i,l,s){var b=this;_classCallCheck(this,e),this.formBuilder=t,this.app=r,this.auth=n,this.cartService=i,this.http=l,this.router=s,this.destroyed$=new o.a(1),this.complete=!1,this.loading=!1,this.cart=[],this.Currensy=c.b,this.user=new u.a,this.app.currencyState$.subscribe((function(e){return b.currencyState=e})),this.orderFormGroup=this.formBuilder.group({email:[null,[a.r.required,a.r.email]],firstName:[null,[a.r.required,a.r.minLength(3)]],lastName:[null,[a.r.required,a.r.minLength(3)]],address:[null,[a.r.required,a.r.minLength(3)]]})}return _createClass(e,[{key:"extractProduct",value:function(e){var t=[];return e&&e.length>0&&e.forEach((function(e){t.push({product:e.product.id,quantity:e.quantity})})),t}},{key:"ngOnInit",value:function(){var e=this;this.cartService.cart$.pipe(Object(i.a)(this.destroyed$)).subscribe((function(t){return e.cart=t})),this.auth.user$.pipe(Object(i.a)(this.destroyed$)).subscribe((function(t){e.user=t,e.user.id&&(e.orderFormGroup.setControl("email",new a.d({value:t.email,disabled:!0})),e.orderFormGroup.patchValue({firstName:t.firstName,lastName:t.lastName}))}))}},{key:"changeCurrency",value:function(e){this.app.currencyState$.next(e.value)}},{key:"submitForm",value:function(){var e=this;if(this.orderFormGroup.valid){this.loading=!0;var t=this.orderFormGroup.value,r=t.email,n=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(t,["email"]),a=Object.assign(Object.assign({},n),{email:this.user.email?this.user.email:r,products:this.extractProduct(this.cart)});this.http.create("orders",a).subscribe((function(t){e.cartService.clearCart(),e.complete=!0,e.loading=!1}),(function(t){e.loading=!1}))}else this.orderFormGroup.markAllAsTouched()}},{key:"goBack",value:function(){this.router.navigate(["/cart"])}},{key:"getTotalPrice",value:function(){if(this.cart.length>0){var e=0;return this.cart.forEach((function(t){e+=t.quantity*t.product.price})),e+2.99}}},{key:"ngOnDestroy",value:function(){this.destroyed$.next(!0),this.destroyed$.complete()}}]),e}(),U.\u0275fac=function(e){return new(e||U)(l.Ob(a.c),l.Ob(c.a),l.Ob(s.a),l.Ob(b.a),l.Ob(m.a),l.Ob(n.a))},U.\u0275cmp=l.Ib({type:U,selectors:[["nat-checkout"]],decls:3,vars:2,consts:[["title","Ordering"],[4,"ngIf"],[1,"checkout","row","row-cols-1","row-cols-lg-2"],[1,"checkout__form","col"],[3,"formGroup"],["appearance","fill"],["matInput","","formControlName","email","placeholder","Enter your email","required",""],["matInput","","formControlName","firstName","placeholder","Enter your first name","required",""],["matInput","","formControlName","lastName","placeholder","Enter your last name","required",""],["matInput","","formControlName","address","placeholder","Enter your address","required",""],["mat-raised-button","",1,"mr-2",3,"click"],["mat-raised-button","","color","accent",3,"disabled","click"],[1,"checkout__cart","col"],[3,"cart","currency","totalPrice","mode"],[1,"complete-text","text-center"],[1,"text-center"],["routerLink","/home","mat-raised-button","","color","primary",1,"m-link"]],template:function(e,t){1&e&&(l.Pb(0,"upper",0),l.Ac(1,k,33,8,"div",1),l.Ac(2,P,7,1,"div",1)),2&e&&(l.Cb(1),l.mc("ngIf",!t.complete),l.Cb(1),l.mc("ngIf",t.complete))},directives:[d.a,f.l,a.s,a.m,a.g,p.c,p.f,h.b,a.b,a.l,a.f,a.q,g.b,y.a,C.a,n.b,g.a],styles:[".mat-stepper-horizontal[_ngcontent-%COMP%]{margin-top:8px}.mat-form-field[_ngcontent-%COMP%]{margin-top:10px;width:100%}.mat-line[_ngcontent-%COMP%]{white-space:normal!important}.price-col[_ngcontent-%COMP%]{flex:0 0 75px;text-align:right}.complete-text[_ngcontent-%COMP%]{font-size:1.5rem;margin:50px 0}"]}),U)}],G=((w=function e(){_classCallCheck(this,e)}).\u0275mod=l.Mb({type:w}),w.\u0275inj=l.Lb({factory:function(e){return new(e||w)},imports:[[n.c.forChild(x)],n.c]}),w),j=r("PCNd"),q=r("5dmV"),I=r("sHgf"),N=r("RjRH"),E=((_=function e(){_classCallCheck(this,e)}).\u0275mod=l.Mb({type:_}),_.\u0275inj=l.Lb({factory:function(e){return new(e||_)},imports:[[G,j.a,q.a,I.a,N.a]]}),_)}}]);